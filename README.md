# Описание программы
___
1. [Общее](#общее)
2. [Установка](#установка)
3. [Подключение](#подключение)
4. [Выбор прошивки](#выбор-прошивки)
5. [Загрузка прошивки](#загрузка-прошивки)

## Общее
- Данная версия программы преднозначена для записи и регистрации одного приложения.
- Общие данные о состоянии находяться в разделе [App flash info](#app-flash-info).
- Общие данные о основных операция чтения-записи находяться в разделе [Status](#status).
- [Кнопки управления](#кнопки-управления).

![меню Connection](/Images/Screenshot_8.png).

### App flash info
- "BootStartAddress" и "BootEndAddress" - раздел памяти загрузчика.
- "AppStartAddress" и "AppEndAddress" - раздел памяти установленого приложения.
- "Crc" - контрольная сумма приложения.
- "BootIsEnable" - "true" соответствует включенному загрузчику.
- "Reset", "JumpToMain", "JumpToBoot" - флаги выполняемых операций загрузчиком.
- "AppCrcError" - флаг ошибки расчета контрольной суммы при попытке запуска основного приложения.
### Status
- "WriteAddress" - последний запрашиваемый адрес записи.
- "ReadAddress" - последний запрашиваемый адрес чтения.
- "EraseAddress" - последний запрашиваемый адрес очистки.
- "Write", "Read", "Erase" - флаги выполняемой операции.
- "FlashUnlocked" - флаг разблокировки памяти.
- "Operation" - последняя операция.
- "OperationTime" - время выполнения "Operation".
- "OperationResult" - результат выполнения "Operation".
### Кнопки управления
- "Communication" - зеленый цвет соответствует успешному обмену данными с загрузчиком.
- "Load" - начать загрузку. Для успешной загрузки нада выбрать файл прошивки, раблокировать память нажав на "FlashUnlocked" в разделе [Status](#status) установив в "true", произвести очистку нажав "Erase". После успешной загрузки "OperationResult" должен быть "Accept".
- "Stop" - остановить загрузку.
- "Erase" - очисткить память под устанавливаемое приложение. Для очистки установить "FlashUnlocked" в режим "true". При еспешной очистке "OperationResult" по операции "Erase" должен быть "Accept".
- "ToMain" - попытка перехода в основное приложение.
- "ToBoot" - попытка перехода в загрузчик.
- "Reset" - перезагрузка устройства. После перезагрузки, загрузчиком будет проверен раздел памяти приложения и при совподении контольной суммы вызвано основное приложение.
- "Read" - xxx.

## Установка
- Скачать программу можно по [ссылке](https://gitlab.adani.by:2443/rekuts/Desktop_Bootloader_STM32/-/archive/main/Desktop_Bootloader_STM32-main.zip?path=Bootloader/Application).
- Архив распаковать, приложение находиться в "название скаченного архива"/Desktop_Bootloader_STM32-main-Bootloader-Application/Bootloader/Application/BootloaderDesktop.exe

## Подключение
- Возможные интерфейсы одключения находяться в меню "Connection".
- Подключение по SerialPort устанавливается в меню "Connection" - "SerialPort". Установив нужную скорость и Port нажать "Connect". При успешно установленом подключении индикатор меню "SerialPort" и индикатор в окне "SerialPort" будут зелеными.

![меню Connection](/Images/Screenshot_7.png).

![меню Connection-SerialPort](/Images/Screenshot_3.png).

- Подключение по TCP устанавливается в меню "Connection" - "Tcp". Установив адрес устройства нажать "Connect". При успешно установленом подключении индикатор меню "Tcp" и индикатор в окне "Tcp" будут зелеными.

![меню Connection](/Images/Screenshot_6.png).

![меню Connection-Tcp](/Images/Screenshot_5.png).

- При подключенном "SerialPort" и "TCP" предпочтение по обменну данными будет отдоваться SerialPort.
- При успешном обмене данными с загрузчиком индикатор "Communication", находящийся в правом верхнем углу окна, будет зеленым.

## Выбор прошивки
- Программа работает с файлами .hex.
- Для выбора прошивки выбрать "File" - "Open" и в диологовом окне указать файл. При успешном окрытии будет показано содержимое.

![меню File](/Images/Screenshot_4.png).

![меню File-Open](/Images/Screenshot_2.png).

## Загрузка прошивки
- Установить подключение выполнив пункт [Подключение](#подключение) и убедиться наличию связи с загрузчиком.
- Выбрать файл прошивки выполнив пункт [Выбор прошивки](#выбор_прошивки).
- Перейти в режим загрузчика нажав "ToBoot" в разделе [Кнопки управления](#кнопки_управления), флаг "BootIsEnable" в разделе [App flash info](#app-flash-info) должен стать "true".
- Разюлокировать память нажав на "FlashUnlocked" в разделе [Status](#статус).
- Произвести очистку памяти нажав "Erase" в разделе [Кнопки управления](#кнопки_управления).
- Начать загрузку нажав "Load" в разделе [Кнопки управления](#кнопки_управления).
- Дождаться окончания загрзки. После этого нажать "Reset" или "ToMain" в разделе [Кнопки управления](#кнопки_управления), для перехода в основное приложения.
